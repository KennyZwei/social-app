(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{115:function(e,t,n){e.exports={messages:"messages_messages__1qX_-"}},117:function(e,t,n){e.exports={main:"addMessage_main__1IXIV",chats:"addMessage_chats__2gi_y"}},119:function(e,t,n){e.exports={users:"users_users__2SbPZ"}},120:function(e,t,n){},121:function(e,t,n){e.exports={main:"preloader_main__3DnQr",chats:"preloader_chats__mI3Pm"}},125:function(e,t,n){e.exports={profile:"profile_profile__2H8gL"}},126:function(e,t,n){e.exports={add_post:"addPost_add_post__3g36H"}},127:function(e,t,n){e.exports={main:"posts_main__hJC6Z"}},128:function(e,t,n){e.exports={profile_info:"profileInfo_profile_info__1IFfq"}},129:function(e,t,n){},133:function(e,t,n){e.exports={textarea:"textarea_textarea__3vIn1"}},139:function(e,t,n){},140:function(e,t,n){},18:function(e,t,n){e.exports={button:"button_button__2Yz2p"}},25:function(e,t,n){e.exports={navbar:"navbar_navbar__hxMYq",active:"navbar_active__2snjV",item:"navbar_item__1JAKC"}},267:function(e,t,n){"use strict";n.r(t);var a,s,r=n(1),c=n.n(r),i=n(53),o=n.n(i),u=(n(139),n(5)),l=n(6),d=n(12),j=n(13),f=(n(140),n.p+"static/media/profileIcon.78b64d9f.svg"),m=n.p+"static/media/messagesIcon.be1f0c90.svg",b=n.p+"static/media/usersIcon.aab30264.svg",p=n(25),g=n.n(p),h=n(9),O=n(0),v=function(){return Object(O.jsxs)("nav",{className:g.a.navbar,children:[Object(O.jsxs)("div",{className:g.a.item,children:[Object(O.jsx)("img",{src:f}),Object(O.jsx)(h.b,{activeClassName:g.a.active,to:"/profile",children:"Profile"})]}),Object(O.jsxs)("div",{className:g.a.item,children:[Object(O.jsx)("img",{src:m}),Object(O.jsx)(h.b,{activeClassName:g.a.active,to:"/dialogs",children:"Messages"})]}),Object(O.jsxs)("div",{className:g.a.item,children:[Object(O.jsx)("img",{src:b}),Object(O.jsx)(h.b,{activeClassName:g.a.active,to:"/users",children:"Users"})]}),Object(O.jsxs)("div",{className:g.a.item,children:[Object(O.jsx)("img",{src:m}),Object(O.jsx)(h.b,{activeClassName:g.a.active,to:"/chat",children:"Chat"})]})]})},x=n(8),_=n(76),N=n.n(_),C=n(59),w=n.n(C),S=function(e){return Object(O.jsxs)("div",{className:w.a.main,children:[Object(O.jsx)("div",{className:w.a.avatar,children:Object(O.jsx)("img",{alt:"avatar",src:"https://yt3.ggpht.com/a/AGF-l79_strxcWBhokrn4lOPA5P6GIcCZSmxUOKmDA=s900-c-k-c0xffffffff-no-rj-mo"})}),Object(O.jsx)(h.b,{to:"/dialogs/"+e.id,className:w.a.chat_name,children:e.name})]})},P=n(115),I=n.n(P),E=n(28),F=n.n(E),T=n(3),y=function(e){return e.auth.isAuth},M=function(e){return e.auth.userId},A=function(e){return e.auth.captchaURL},k=function(e){return e.auth.login},L=function(e){var t=Object(T.c)(M);return Object(O.jsxs)("div",{className:"".concat(F.a.main," ").concat(e.className||""," ").concat(e.userId===t?F.a.me:F.a.notMe),children:[Object(O.jsx)("div",{className:F.a.avatar,children:Object(O.jsx)(h.b,{to:"profile/"+e.userId,children:Object(O.jsx)("img",{alt:"avatar",src:e.avatar||"https://pixelbox.ru/wp-content/uploads/2020/12/avatar-youtube-99.jpg"})})}),Object(O.jsxs)("div",{className:F.a.messageInfo,children:[Object(O.jsx)("div",{className:F.a.name,children:Object(O.jsx)("h4",{children:e.name})}),Object(O.jsx)("div",{className:"".concat(F.a.message," ").concat(F.a.newMessage),children:Object(O.jsx)("p",{children:e.message})})]})]})},U=function(e){var t=e.messages.map((function(e){return e.me?Object(O.jsx)(L,{userId:e.id,className:"me",name:e.name,message:e.message}):Object(O.jsx)(L,{userId:e.id,name:e.name,message:e.message})}));return Object(O.jsx)("div",{className:I.a.messages,children:t})},D=n(117),R=n.n(D),q=function(e){return Object(O.jsxs)("div",{className:R.a.add_message,children:[Object(O.jsx)("textarea",{onChange:function(t){var n=t.target.value;e.updateNewMessageText(e.id,n)},value:e.newMessageText}),Object(O.jsx)("button",{onClick:function(){e.addMessage(e.id)},children:"send message"})]})},H=function(e){var t=e.chats.map((function(e){return Object(O.jsx)(S,{name:e.name,id:e.id})})),n=e.chats.map((function(t){return Object(O.jsx)(x.b,{path:"/dialogs/"+t.id,render:function(){return Object(O.jsxs)("div",{children:[Object(O.jsx)(U,{messages:t.messages}),Object(O.jsx)(q,{id:t.id,newMessageText:t.newMessageText,updateNewMessageText:e.updateNewMessageText,addMessage:e.addMessage})]})}})}));return Object(O.jsxs)("div",{className:N.a.main,children:[Object(O.jsx)("div",{className:N.a.chats,children:t}),n]})},G=n(10),V=n(2),J="social/dialogs/UPDATE-NEW-MESSAGE-TEXT",W="social/dialogs/ADD-MESSAGE",z={chats:[{id:1,name:"Salich",messages:[{id:1,name:"Salich",message:"Hi",me:!1},{id:2,name:"Me",message:"Hi, Yoyo",me:!0}],newMessageText:""},{id:2,name:"Lenar",messages:[{id:1,name:"Lenar",message:"How",me:!1},{id:2,name:"Me",message:"Just do it!!!!!",me:!0}],newMessageText:""}]},B=function(e,t){return{type:J,id:e,newText:t}},Z=function(e){return{type:W,id:e}},K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case J:return Object(V.a)(Object(V.a)({},e),{},{chats:e.chats.map((function(e){return e.id===t.id&&(e.newMessageText=t.newText),e}))});case W:return Object(V.a)(Object(V.a)({},e),{},{chats:e.chats.map((function(e){return t.id===e.id&&(e.messages=[].concat(Object(G.a)(e.messages),[{id:4,name:"me",message:e.newMessageText,me:!0}]),e.newMessageText=""),e}))});default:return e}},X=n(16),Y=function(e){return{isAuth:y(e)}},Q=function(e){return Object(T.b)(Y)((function(t){return t.isAuth?Object(O.jsx)(e,Object(V.a)({},t)):Object(O.jsx)(x.a,{to:"/login"})}))},$=function(e){return e.dialogsPage.chats},ee=B,te=Z,ne=Object(X.c)(Q,Object(T.b)((function(e){return{chats:$(e)}}),{addMessage:te,updateNewMessageText:ee}))(H),ae=n(118),se=n(119),re=n.n(se),ce=n(15),ie=n(45),oe=n.n(ie),ue=n(18),le=n.n(ue),de=n.p+"static/media/avatar.c5d81277.jpg",je=c.a.memo((function(e){var t=Object(r.useState)(!1),n=Object(ce.a)(t,2),a=n[0],s=n[1],c=e.followed?"unfollow":"follow";return Object(O.jsxs)("div",{className:oe.a.user,children:[Object(O.jsx)("div",{className:oe.a.avatar,children:Object(O.jsx)(h.b,{to:"profile/".concat(e.id),children:Object(O.jsx)("img",{alt:"photo",src:e.photo||de})})}),Object(O.jsxs)("div",{children:[Object(O.jsxs)("div",{className:oe.a.user_information,children:[Object(O.jsx)("span",{className:oe.a.name,children:e.name}),Object(O.jsxs)("p",{children:["status: ",e.status||"-"]})]}),Object(O.jsx)("button",{className:le.a.button,onClick:function(){s(!0),e.toggleFollowed(e.id,e.followed).then((function(){s(!1)}))},disabled:a,children:c})]})]})})),fe=n(120),me=n.n(fe),be=n(121),pe=n.n(be),ge=n.p+"static/media/preloader.43f87d1d.svg",he=function(){return Object(O.jsx)("div",{className:pe.a.main,children:Object(O.jsx)("img",{alt:"Loading...",src:ge})})},Oe=c.a.memo((function(e){var t;return e.currentPage<e.totalPageCount&&(t=Object(O.jsx)("button",{onClick:e.moreItems,children:"More"})),Object(O.jsx)("div",{className:me.a.moreButton,children:e.isFetching?Object(O.jsx)(he,{}):t})})),ve=n(40),xe=n.n(ve),_e=function(e){var t=e.onClick,n=e.value,a=e.appendClassName,s=void 0===a?"":a;return Object(O.jsx)("div",{onClick:t,className:"".concat(xe.a.pageNumber," ").concat(s),children:n})},Ne=c.a.memo((function(e){var t=function(e,t,n){var a=[];if(t>6){for(var s=1;s<4;s++)a.push(Object(O.jsx)(_e,{onClick:n,value:s}));a.push(Object(O.jsx)(_e,{value:"..."}))}if(t+4<e){for(var r,c=r=1!==t?t-1:t;c<r+3;c++)c===t?a.push(Object(O.jsx)(_e,{value:c,onClick:n,appendClassName:xe.a.active})):a.push(Object(O.jsx)(_e,{value:c,onClick:n}));a.push(Object(O.jsx)(_e,{value:"..."}));for(var i=e-3;i<=e;i++)a.push(Object(O.jsx)(_e,{value:i,onClick:n}))}else for(var o=e-5;o<=e;o++)o===t?a.push(Object(O.jsx)(_e,{value:o,onClick:n,appendClassName:xe.a.active})):a.push(Object(O.jsx)(_e,{value:o,onClick:n}));return a}(e.totalPageCount,e.currentPage,(function(t){var n=parseInt(t.currentTarget.innerHTML);e.setCurrentPage(n),e.getItems(n,"",null)}));return Object(O.jsx)("div",{className:xe.a.pagination,children:Object(O.jsx)("div",{className:xe.a.pageNumbers,children:t})})})),Ce=n(19),we=n(30),Se=n.n(we),Pe=function(e){var t=e.name,n=e.error,a=e.labelText,s=void 0===a?t:a,r=e.addComponent,c=void 0===r?null:r,i=e.inputTeg,o=void 0===i?"input":i,u=e.type,l=void 0===u?"text":u,d=e.placeholder,j=void 0===d?t:d,f=e.innerField,m=void 0===f?null:f;return Object(O.jsxs)("div",{className:Se.a.formField,children:[Object(O.jsx)("label",{className:Se.a.label,htmlFor:t,children:s}),c,Object(O.jsxs)("div",{className:Se.a.content,children:[Object(O.jsx)(Ce.a,{className:"".concat(Se.a[o]," ").concat(Se.a.field),as:o,id:t,type:l,name:t,placeholder:j,children:null===m||void 0===m?void 0:m.map((function(e){return e}))}),n?Object(O.jsxs)("div",{className:Se.a.errorContent,children:[Object(O.jsx)("div",{className:Se.a.errorIcon,children:"!"}),Object(O.jsx)("span",{className:Se.a.errorMessage,children:n})]}):null]})]})},Ie=function(e){var t=e.requestUsersAndSetSearchConfig;return Object(O.jsx)("div",{className:"searchForm",children:Object(O.jsx)(Ce.c,{initialValues:{term:"",friend:null},onSubmit:function(e){var n;t(1,e.term,"null"===(n=e.friend)?null:"true"===n)},children:function(e){var t=e.errors;return Object(O.jsxs)(Ce.b,{children:[Object(O.jsx)(Pe,{name:"term",error:t.term}),Object(O.jsx)(Pe,{name:"friend",error:t.term,inputTeg:"select",innerField:[Object(O.jsx)("option",{value:"null",selected:!0,children:"All users"}),Object(O.jsx)("option",{value:"true",children:"Only friends"}),Object(O.jsx)("option",{value:"false",children:"Not friends"})]}),Object(O.jsx)("button",{children:"Search"})]})}})})},Ee=["requestUsersAndSetSearchConfig"],Fe=function(e){var t=e.requestUsersAndSetSearchConfig,n=Object(ae.a)(e,Ee),a=Math.ceil(n.totalUsersCount/n.pageUsersLimit);Object(r.useEffect)((function(){return n.requestMoreUsers(n.currentPage,n.searchConfig.term,n.searchConfig.friend),function(){n.setCurrentPage(1),n.deleteUsers()}}),[]);var s=n.users.map((function(e){return Object(O.jsx)(je,{name:e.name,photo:e.photos.small,status:e.status,id:e.id,toggleFollowed:n.toggleFollowed,followed:e.followed},e.id)}));return Object(O.jsxs)("div",{className:re.a.users,children:[Object(O.jsx)(Ie,{requestUsersAndSetSearchConfig:t}),Object(O.jsx)(Ne,{currentPage:n.currentPage,totalPageCount:a,setCurrentPage:n.setCurrentPage,getItems:n.requestUsers}),s,Object(O.jsx)(Oe,{isFetching:n.isFetching,currentPage:n.currentPage,totalPageCount:a,moreItems:function(){n.requestMoreUsers(n.currentPage+1,n.searchConfig.term,n.searchConfig.friend)}})]})},Te=n(23),ye=n.n(Te),Me=n(34),Ae=n(124),ke=n.n(Ae).a.create({withCredentials:!0,baseURL:"https://social-network.samuraijs.com/api/1.0/",headers:{"API-KEY":"ceadf895-0db0-4dec-9487-79601e86c00a"}});!function(e){e[e.Success=0]="Success",e[e.Error=1]="Error"}(a||(a={})),function(e){e[e.NeedCaptcha=10]="NeedCaptcha"}(s||(s={}));var Le=function(e,t,n){return ke.get("users?page=".concat(e,"&term=").concat(t,"&friend=").concat(n)).then((function(e){return e.data}))},Ue=function(e){return ke.post("follow/".concat(e)).then((function(e){return e.data}))},De=function(e){return ke.delete("follow/".concat(e)).then((function(e){return e.data}))},Re="social/users/APPEND-USERS",qe="social/users/SET-TOTAL-USERS-COUNT",He="social/users/SET-CURRENT-PAGE",Ge="social/users/SET-IS-FETCHING",Ve="social/users/DELETE-USERS",Je="social/users/TOGGLE-FOLLOWED",We="social/users/SET-USERS",ze="social/users/SET-SEARCH-CONFIG",Be={users:[],totalUsersCount:0,pageUsersLimit:10,isFetching:!1,currentPage:1,searchConfig:{friend:null,term:""}},Ze=function(e){return{type:Re,users:e}},Ke=function(e){return{type:We,users:e}},Xe=function(e){return{type:qe,totalUsersCount:e}},Ye=function(e){return{type:He,currentPage:e}},Qe=function(e){return{type:Ge,isFetching:e}},$e=function(){return{type:Ve}},et=function(e){return{type:Je,id:e}},tt=function(e){return{type:ze,searchConfig:e}},nt=function(e,t,n){return function(a){a($e()),a(Qe(!0)),Le(e,t,n).then((function(e){null===e.error&&(a(Xe(e.totalCount)),a(Ke(e.items)),a(Qe(!1)))}))}},at=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Re:return Object(V.a)(Object(V.a)({},e),{},{users:[].concat(Object(G.a)(e.users),Object(G.a)(t.users))});case qe:return Object(V.a)(Object(V.a)({},e),{},{totalUsersCount:t.totalUsersCount});case He:return Object(V.a)(Object(V.a)({},e),{},{currentPage:t.currentPage});case Ge:return Object(V.a)(Object(V.a)({},e),{},{isFetching:t.isFetching});case Ve:return Object(V.a)(Object(V.a)({},e),{},{users:[]});case We:return Object(V.a)(Object(V.a)({},e),{},{users:t.users});case Je:return Object(V.a)(Object(V.a)({},e),{},{users:e.users.map((function(e){return e.id===t.id&&(e.followed=!e.followed),e}))});case ze:return Object(V.a)(Object(V.a)({},e),{},{searchConfig:t.searchConfig});default:return e}},st=function(e){return e.usersPage.users},rt=function(e){return e.usersPage.currentPage},ct=function(e){return e.usersPage.totalUsersCount},it=function(e){return e.usersPage.pageUsersLimit},ot=function(e){return e.usersPage.isFetching},ut=function(e){return e.usersPage.searchConfig},lt=$e,dt=Ye,jt=Object(X.c)(Object(T.b)((function(e){return{users:st(e),currentPage:rt(e),totalUsersCount:ct(e),pageUsersLimit:it(e),isFetching:ot(e),searchConfig:ut(e)}}),{setCurrentPage:dt,deleteUsers:lt,toggleFollowed:function(e,t){return function(){var n=Object(Me.a)(ye.a.mark((function n(s){var r;return ye.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=6;break}return n.next=3,De(e);case 3:r=n.sent,n.next=9;break;case 6:return n.next=8,Ue(e);case 8:r=n.sent;case 9:r.resultCode===a.Success&&s(et(e));case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},requestMoreUsers:function(e,t,n){return function(a){a(Qe(!0)),a(Ye(e)),Le(e,t,n).then((function(e){null===e.error&&(a(Xe(e.totalCount)),a(Ze(e.items)),a(Qe(!1)))}))}},requestUsers:nt,requestUsersAndSetSearchConfig:function(e,t,n){return function(a){a(tt({term:t,friend:n})),a(nt(e,t,n))}}}))(Fe),ft=n(125),mt=n.n(ft),bt=n(126),pt=n.n(bt),gt=function(e){var t=Object(r.useState)("new"),n=Object(ce.a)(t,2),a=n[0],s=n[1];return Object(O.jsxs)("div",{className:pt.a.add_post,children:[Object(O.jsx)("textarea",{onChange:function(e){s(e.currentTarget.value)},value:a}),Object(O.jsx)("button",{onClick:function(){e.addPost(a)},children:"Add post"})]})},ht=function(e){return ke.get("profile/".concat(e)).then((function(e){return e.data}))},Ot=function(e){return ke.put("profile",e).then((function(e){return e.data}))},vt=function(e){return ke.get("profile/status/".concat(e)).then((function(e){return e.data}))},xt=function(e){var t=new FormData;return t.append("image",e),ke.put("profile/photo",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){return e.data}))},_t="social/profile/ADD-POST",Nt="social/profile/SET-PROFILE-INFORMATION",Ct="social/profile/SET-IS-FETCHING",wt="social/profile/SET-STATUS",St="social/profile/SAVE_IMAGE",Pt="social/profile/SET-IS-OWNER",It="social/profile/SET-OWNER-PROFILE-INFORMATION",Et={posts:[{id:1,message:"Hi",name:"FIO",likeCount:10},{id:2,message:"How are you?",name:"FIO",likeCount:15}],profile:null,ownerProfile:null,status:"",isFetching:!0,isOwner:!1},Ft=function(e){return{type:Ct,isFetching:e}},Tt=function(e){return{type:wt,status:e}},yt=function(e){return{type:St,photos:e}},Mt=function(e){return{type:Pt,isOwner:e}},At=function(e){return{type:Nt,profile:e}},kt=function(e){return{type:It,profile:e}},Lt=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n){n(Ft(!0));var a=n(Ut(e)),s=ht(e);return Promise.all([a,s]).then((function(e){var a=Object(ce.a)(e,2),s=(a[0],a[1]);n(t?kt(s):At(s)),n(Ft(!1))}))}},Ut=function(e){return function(t){vt(e).then((function(e){t(Tt(e))}))}},Dt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Et,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _t:return Object(V.a)(Object(V.a)({},e),{},{posts:[].concat(Object(G.a)(e.posts),[{id:3,message:t.newPostText,name:"FIO",likeCount:0}])});case Nt:return Object(V.a)(Object(V.a)({},e),{},{profile:Object(V.a)(Object(V.a)({},e.profile),t.profile)});case Ct:return Object(V.a)(Object(V.a)({},e),{},{isFetching:t.isFetching});case wt:return Object(V.a)(Object(V.a)({},e),{},{status:t.status});case St:var n=e.profile?Object(V.a)(Object(V.a)({},e.profile),{},{photos:t.photos}):null;return Object(V.a)(Object(V.a)({},e),{},{profile:n});case Pt:return Object(V.a)(Object(V.a)({},e),{},{isOwner:t.isOwner});case It:return Object(V.a)(Object(V.a)({},e),{},{ownerProfile:Object(V.a)({},t.profile)});default:return e}},Rt=function(e){return{type:_t,newPostText:e}},qt=Object(T.b)(null,{addPost:Rt})(gt),Ht=n(127),Gt=n.n(Ht),Vt=n(77),Jt=n.n(Vt),Wt=function(e){return Object(O.jsxs)("div",{className:Jt.a.main,children:[Object(O.jsx)(L,{userId:1,name:e.name,message:e.message}),Object(O.jsxs)("div",{className:Jt.a.likes,children:[Object(O.jsx)("button",{children:"Like"}),Object(O.jsx)("p",{children:e.like_count})]})]})},zt=function(e){var t=e.posts.map((function(e){return Object(O.jsx)(Wt,{message:e.message,name:e.name,like_count:e.likeCount},e.id)}));return Object(O.jsx)("div",{className:Gt.a.posts,children:t})},Bt=function(e){return e.profilePage.profile},Zt=function(e){return e.profilePage.ownerProfile},Kt=function(e){return e.profilePage.isFetching},Xt=function(e){return e.profilePage.posts},Yt=function(e){return e.profilePage.isOwner},Qt=function(e){var t;return null===(t=e.profilePage.profile)||void 0===t?void 0:t.photos},$t=Object(T.b)((function(e){return{posts:Xt(e)}}))(zt),en=n(128),tn=n.n(en),nn=n(60),an=n.n(nn),sn=function(e){var t=e.fileIsSelected;return Object(O.jsx)("div",{className:an.a.avatarSettings,children:Object(O.jsxs)("div",{className:an.a.uploadFile,children:[Object(O.jsx)("label",{htmlFor:"file"}),Object(O.jsx)("input",{id:"file",onChange:t,type:"file"})]})})},rn=function(e){return Object(O.jsxs)("div",{className:an.a.avatar,children:[Object(O.jsx)("img",{alt:"\u0444\u043e\u043d",src:e.photo||de}),e.isOwner?Object(O.jsx)(sn,{fileIsSelected:function(t){var n=t.currentTarget.files;null!==n&&n[0]&&e.saveImage(n[0])}}):null]})},cn=n(78),on=n.n(cn),un=n(79),ln=n.n(un),dn=function(e){var t=e.className,n=void 0===t?"":t,a=e.children,s=e.label;return Object(O.jsxs)("div",{className:"".concat(ln.a.itemList," ").concat(n),children:[Object(O.jsx)("span",{children:s}),Object(O.jsx)("div",{className:ln.a.items,children:a})]})},jn=function(e){var t=e.itemName,n=e.itemValue,a=e.isLink,s=void 0!==a&&a;return Object(O.jsxs)("div",{className:on.a.infoItem,children:[Object(O.jsx)("span",{children:"".concat(t,":")}),s?Object(O.jsxs)("a",{rel:"noreferrer",href:n,target:"_blank",children:[" ",n," "]}):Object(O.jsx)("p",{children:n})]})},fn=function(e){var t=e.profile,n=e.onEdit,a=e.isOwner;return Object(O.jsxs)("div",{className:on.a.profileData,children:[Object(O.jsxs)(dn,{label:"Personal information",children:[Object(O.jsx)(jn,{itemName:"Full name",itemValue:t.fullName}),Object(O.jsx)(jn,{itemName:"About me",itemValue:t.aboutMe}),Object(O.jsx)(jn,{itemName:"Skills",itemValue:t.lookingForAJobDescription})]}),Object(O.jsx)(dn,{label:"Contacts",children:Object.keys(t.contacts).map((function(e){return Object(O.jsx)(jn,{isLink:!0,itemName:e,itemValue:t.contacts[e]})}))}),a?Object(O.jsx)("button",{className:le.a.button,onClick:n,children:"Edit Information"}):null]})},mn=n(61),bn=n.n(mn),pn=function(e){var t=e.errors,n=e.profile,a=e.isSubmitting;return Object(O.jsx)("div",{className:bn.a.profileDataForm,children:Object(O.jsxs)(Ce.b,{className:bn.a.loginForm,children:[Object(O.jsxs)(dn,{label:"Personal information",children:[Object(O.jsx)(Pe,{name:"fullName",error:t.fullName}),Object(O.jsx)(Pe,{name:"aboutMe",labelText:"about Me",error:t.aboutMe,inputTeg:"textarea"}),Object(O.jsx)(Pe,{name:"lookingForAJobDescription",labelText:"skills",error:t.lookingForAJobDescription,inputTeg:"textarea"})]}),Object(O.jsx)(dn,{label:"Contacts",children:Object.keys(n.contacts).map((function(e){return Object(O.jsx)(Pe,{labelText:e,name:"contacts.".concat(e),placeholder:e,error:t[e]})}))}),Object(O.jsx)("button",{className:le.a.button,type:"submit",disabled:a,children:"Save"}),Object(O.jsx)("div",{className:bn.a.APIError})]})})},gn=Object(Ce.d)({mapPropsToValues:function(e){var t=e.profile;return{fullName:t.fullName,aboutMe:t.aboutMe,lookingForAJobDescription:t.lookingForAJobDescription,lookingForAJob:!0,contacts:t.contacts}},validateOnBlur:!0,validateOnChange:!1,handleSubmit:function(e,t){t.props.setProfileInformation(Object(V.a)(Object(V.a)({},t.props.profile),e)),t.props.onEditOff()}})(pn),hn=function(e){var t=Object(r.useState)(!1),n=Object(ce.a)(t,2),a=n[0],s=n[1],c=e.isOwner?e.ownerProfile:e.profile;return e.isFetching||null===c?Object(O.jsx)(he,{}):Object(O.jsxs)("div",{className:tn.a.profile_info,children:[Object(O.jsx)(rn,{saveImage:e.saveImage,photo:null===c||void 0===c?void 0:c.photos.large,isOwner:e.isOwner}),a?Object(O.jsx)(gn,{setProfileInformation:e.setProfileInformation,onEditOff:function(){return s(!1)},profile:c}):Object(O.jsx)(fn,{isOwner:e.isOwner,onEdit:function(){return s(!0)},profile:c})]})},On=Object(T.b)((function(e){return{isFetching:Kt(e),isOwner:Yt(e)}}),{saveImage:function(e){return function(t){xt(e).then((function(e){e.resultCode===a.Success&&t(yt(e.data.photos))}))}},setProfileInformation:function(e){return function(t){Ot(e).then((function(n){n.resultCode===a.Success&&t(kt(e))}))}}})(hn),vn=function(e){var t=+e.match.params.userId||e.myUserId;return Object(r.useEffect)((function(){var n;t&&t!==(null===(n=e.profile)||void 0===n?void 0:n.userId)&&t!==e.myUserId?(e.getStatus(t),e.requestProfileInformation(t)):t===e.myUserId&&e.ownerProfile,t===e.myUserId?e.setIsOwner(!0):e.setIsOwner(!1)}),[t]),t?Object(O.jsxs)("div",{className:mt.a.profile,children:[Object(O.jsx)(On,{ownerProfile:e.ownerProfile,profile:e.profile}),Object(O.jsx)(qt,{}),Object(O.jsx)($t,{})]}):Object(O.jsx)(x.a,{to:"/login"})},xn=Mt,_n=Object(X.c)(x.f,Object(T.b)((function(e){return{myUserId:M(e),isOwner:Yt(e),profile:Bt(e),ownerProfile:Zt(e)}}),{requestProfileInformation:Lt,getStatus:Ut,setIsOwner:xn}))(vn),Nn=n(80),Cn=n.n(Nn),wn=n(46),Sn=n.n(wn),Pn=function(e){return Object(O.jsxs)("div",{className:Sn.a.logon,children:[Object(O.jsx)("div",{className:Sn.a.userLogin,children:Object(O.jsx)("h3",{children:e.userLogin})}),Object(O.jsx)("div",{className:Sn.a.avatar,children:Object(O.jsx)("img",{alt:"avatar",src:e.smallPhotos||de})}),Object(O.jsx)("div",{className:Sn.a.menu,children:Object(O.jsx)("button",{className:le.a.button,onClick:e.logout,children:"logout"})})]})},In=n(62),En=n.n(In),Fn=function(e){return Object(O.jsxs)("div",{className:En.a.logout,children:[Object(O.jsx)(h.b,{to:"/login",children:Object(O.jsx)("button",{className:"".concat(En.a.login," ").concat(le.a.button),children:"Login"})}),Object(O.jsx)("button",{className:"".concat(En.a.registration," ").concat(le.a.button),children:"Registration"})]})},Tn=function(e){return Object(O.jsxs)("header",{className:Cn.a.header,children:[Object(O.jsx)("div",{className:Cn.a.icon,children:Object(O.jsx)("img",{src:"https://e7.pngegg.com/pngimages/197/457/png-clipart-round-multicolored-logo-vanamo-logo-icons-logos-emojis-tech-companies.png"})}),e.isAuth?Object(O.jsx)(Pn,{smallPhotos:e.smallPhotos,userLogin:e.login,logout:e.logout}):Object(O.jsx)(Fn,{})]})},yn=function(){return ke.get("auth/me").then((function(e){return e.data}))},Mn=function(){return ke.delete("auth/login").then((function(e){return e.data}))},An=function(e,t,n,a){return ke.post("auth/login",{email:e,password:t,rememberMe:n,captcha:a}).then((function(e){return e.data}))},kn=function(){return ke.get("security/get-captcha-url").then((function(e){return e.data}))},Ln="social/auth/SET-PROFILE-DATA",Un="social/auth/SET-CAPTCHA-URL",Dn={userId:null,login:null,email:null,captchaURL:null,isAuth:!1},Rn=function(e){return{type:Ln,payload:e}},qn=function(e){return{type:Un,captchaURL:e}},Hn=function(){return function(e){return yn().then((function(t){if(t.resultCode===a.Success){var n=t.data,s=n.id,r=n.email,c=n.login;e(Rn({userId:s,email:r,login:c,isAuth:!0}))}return t}))}},Gn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Dn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ln:return Object(V.a)(Object(V.a)({},e),t.payload);case Un:return Object(V.a)(Object(V.a)({},e),t);default:return e}},Vn=Object(T.b)((function(e){var t;return{isAuth:y(e),login:k(e),smallPhotos:null===(t=Qt(e))||void 0===t?void 0:t.small}}),{logout:function(){return function(e){Mn().then((function(t){0===t.resultCode&&(e(Rn({userId:null,email:null,login:null,isAuth:!1})),e(Mt(!1)))}))}}})(Tn),Jn="social/app/INITIALIZE",Wn={initialized:!1},zn=function(){return{type:Jn}},Bn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Jn:return Object(V.a)(Object(V.a)({},e),{},{initialized:!0});default:return e}},Zn=n(129),Kn=n.n(Zn),Xn=n(81),Yn=n.n(Xn),Qn=function(e){var t=e.errors,n=e.isSubmitting;return Object(O.jsxs)(Ce.b,{className:Yn.a.loginForm,children:[Object(O.jsx)(Pe,{type:"email",name:"email",error:t.email}),Object(O.jsx)(Pe,{type:"password",name:"password",error:t.password}),e.captchaURL?Object(O.jsx)(Pe,{labelText:"",name:"captcha",error:t.password,addComponent:Object(O.jsx)("img",{alt:"captcha",src:e.captchaURL})}):null,Object(O.jsx)("button",{type:"submit",disabled:n,children:"Login"}),Object(O.jsx)("div",{className:Yn.a.APIError,children:t.APIError})]})},$n=n(63),ea=Object(X.c)(Object(T.b)((function(e){return{captchaURL:A(e)}}),{logon:function(e){var t=e.email,n=e.password,s=e.rememberMe,r=e.captcha,c=void 0===r?null:r;return function(e){return An(t,n,s,c).then((function(t){if(t.resultCode===a.Success)e(Hn());else{if(t.resultCode===a.Error)return t.messages[0];e((function(e){kn().then((function(t){e(qn(t.url))}))}))}}))}}}),Object(Ce.d)({mapPropsToValues:function(){return{email:"",password:"",captcha:"",rememberMe:!1}},validateOnBlur:!0,validateOnChange:!1,validationSchema:$n.a().shape({email:$n.b().email("Incorrect email").required("Required"),password:$n.b().required("Required")}),handleSubmit:function(e,t){var n=t.props,a=t.setFieldValue,s=t.setSubmitting;n.logon(e).then((function(e){a("APIError",e)})).finally((function(){return s(!1)}))}}))(Qn),ta=function(e){return e.isAuth?Object(O.jsx)(x.a,{to:"/profile"}):Object(O.jsx)("div",{className:Kn.a.login,children:Object(O.jsx)(ea,{})})},na=Object(T.b)((function(e){return{isAuth:y(e)}}))(ta),aa=n(83),sa=n.n(aa),ra=function(e){var t=e.messages,n=c.a.createRef();return Object(r.useEffect)((function(){var e;null===(e=n.current)||void 0===e||e.scrollIntoView()}),[t]),Object(O.jsxs)("div",{className:sa.a.chatMessages,children:[t.map((function(e){return Object(O.jsx)(L,{className:sa.a.message,userId:e.userId,name:e.userName,message:e.message,avatar:e.photo})})),Object(O.jsx)("div",{ref:n})]})},ca=n(133),ia=n.n(ca),oa=function(e){var t=e.value,n=e.onChange,a=e.onEnter,s=e.className;return Object(O.jsx)("textarea",{onKeyDown:function(e){"Enter"===e.key&&!e.shiftKey&&a&&(a(),e.preventDefault())},className:"".concat(ia.a.textarea," ").concat(s||""),onChange:function(e){e.currentTarget.style.height="auto",e.currentTarget.style.height=e.currentTarget.scrollHeight+"px",n&&n(e)},value:t})},ua=n(84),la=n.n(ua),da=function(e){var t=e.sendMessage,n=e.status,a=Object(r.useState)(""),s=Object(ce.a)(a,2),c=s[0],i=s[1],o=function(){i(""),t(c)};return Object(O.jsxs)("div",{className:la.a.main,children:[Object(O.jsx)(oa,{className:la.a.textarea,onChange:function(e){i(e.currentTarget.value)},onEnter:o,value:c}),Object(O.jsx)("button",{className:le.a.button,disabled:"connected"!==n,onClick:o,children:"Send"})]})},ja=function(e){var t=e.messages,n=e.startListeningMessages,a=e.sendMessage,s=e.status,c=e.stopListeningMessages;return Object(r.useEffect)((function(){return n(),c}),[]),Object(O.jsxs)("div",{children:[s,Object(O.jsx)(ra,{messages:t}),Object(O.jsx)(da,{sendMessage:a,status:s})]})},fa={statusChanged:[],messagesReceived:[]},ma=null,ba=function(e){fa.statusChanged.forEach((function(t){return t(e)}))},pa=function(e){var t=JSON.parse(e.data);fa.messagesReceived.forEach((function(e){return e(t)}))},ga=function(e){ba("disconnect"),setTimeout(xa.start,3e3)},ha=function(){ba("connected")},Oa=function(){ba("error")},va=function(){ma&&(ma.removeEventListener("message",pa),ma.removeEventListener("close",ga),ma.removeEventListener("open",ha))},xa={stop:function(){var e;fa.statusChanged=[],fa.messagesReceived=[],va(),null===(e=ma)||void 0===e||e.close(),ma=null},start:function(){ba("connecting"),va(),(ma=new WebSocket("wss://social-network.samuraijs.com/handlers/ChatHandler.ashx")).addEventListener("message",pa),ma.addEventListener("open",ha),ma.addEventListener("close",ga),ma.addEventListener("error",Oa)},subscribeEvent:function(e,t){fa[e].push(t)},unSubscribeEvent:function(e,t){fa[e].splice(fa[e].indexOf(t),1)},sendMessage:function(e){var t;null===(t=ma)||void 0===t||t.send(e)}},_a="social/chat/SET-MESSAGE",Na="social/chat/STATUS-CHANGE",Ca="social/chat/DELETE-MESSAGES",wa={messages:[],status:"disconnect"},Sa=function(e){return{type:_a,messages:e}},Pa=function(e){return{type:Na,status:e}},Ia=function(){return{type:Ca}},Ea=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _a:return Object(V.a)(Object(V.a)({},e),{},{messages:[].concat(Object(G.a)(e.messages),Object(G.a)(t.messages))});case Na:return Object(V.a)(Object(V.a)({},e),{},{status:t.status});case Ca:return Object(V.a)(Object(V.a)({},e),{},{messages:[]});default:return e}},Fa=function(e){return e.chat.messages},Ta=function(e){return e.chat.status},ya=Object(T.b)((function(e){return{messages:Fa(e),status:Ta(e)}}),{startListeningMessages:function(){return function(){var e=Object(Me.a)(ye.a.mark((function e(t){return ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:xa.subscribeEvent("statusChanged",(function(e){t(Pa(e))})),xa.start(),xa.subscribeEvent("messagesReceived",(function(e){t(Sa(e))}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},stopListeningMessages:function(){return function(){var e=Object(Me.a)(ye.a.mark((function e(t){return ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:xa.stop(),t(Ia());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},sendMessage:function(e){return function(){var t=Object(Me.a)(ye.a.mark((function t(n){return ye.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:xa.sendMessage(e);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}})(ja),Ma=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.props.initialize()}},{key:"render",value:function(){return this.props.initialized?Object(O.jsxs)("div",{className:"App",children:[Object(O.jsx)(Vn,{}),Object(O.jsx)(v,{}),Object(O.jsxs)("div",{className:"content",children:[Object(O.jsx)(x.b,{path:"/dialogs",component:ne}),Object(O.jsx)(x.b,{path:"/profile/:userId?",component:_n}),Object(O.jsx)(x.b,{path:"/users",component:jt}),Object(O.jsx)(x.b,{path:"/login",component:na}),Object(O.jsx)(x.b,{path:"/chat",component:ya})]})]}):Object(O.jsx)(he,{})}}]),n}(r.Component),Aa=Object(X.c)(Object(T.b)((function(e){return{initialized:e.app.initialized}}),{initialize:function(){return function(){var e=Object(Me.a)(ye.a.mark((function e(t){return ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(Hn()).then((function(e){if(0===e.resultCode)return t(Lt(e.data.id,!0))}));case 2:t(zn());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}))(Ma),ka=n(134),La=Object(X.b)({profilePage:Dt,dialogsPage:K,usersPage:at,auth:Gn,app:Bn,chat:Ea}),Ua=Object(X.d)(La,Object(X.a)(ka.a));window.store=Ua;var Da=Ua;o.a.render(Object(O.jsx)(c.a.StrictMode,{children:Object(O.jsx)(h.a,{children:Object(O.jsx)(T.a,{store:Da,children:Object(O.jsx)(Aa,{store:Da})})})}),document.getElementById("root"))},28:function(e,t,n){e.exports={main:"message_main__2A2Hp",avatar:"message_avatar__3k1CJ",me:"message_me__yc7QH",message:"message_message__143Dw",notMe:"message_notMe__2GJ24",newMessage:"message_newMessage__3jlTn",name:"message_name__11n5h",scale:"message_scale__1bjPU"}},30:function(e,t,n){e.exports={input:"formField_input__3UMwI",textarea:"formField_textarea__2ZdBu",field:"formField_field__X-8fm",formField:"formField_formField__180Fu",errorIcon:"formField_errorIcon__3AHf-",errorMessage:"formField_errorMessage__3FRiS",label:"formField_label__CY4uW",content:"formField_content__2LAuE"}},40:function(e,t,n){e.exports={pagination:"pagination_pagination__ath4W",pageNumbers:"pagination_pageNumbers__3P2I5",pageNumber:"pagination_pageNumber__250d8",active:"pagination_active__VagPV"}},45:function(e,t,n){e.exports={avatar:"user_avatar__23hb6",user:"user_user__3lGn_",name:"user_name__HvLUn"}},46:function(e,t,n){e.exports={logon:"logon_logon__3Nky3",avatar:"logon_avatar__2676T"}},59:function(e,t,n){e.exports={main:"chat_main__3cj8k",avatar:"chat_avatar__3ssfy",chat_name:"chat_chat_name__q6SSs"}},60:function(e,t,n){e.exports={avatar:"avatar_avatar__2rOvh",avatarSettings:"avatar_avatarSettings__2eWRU",uploadFile:"avatar_uploadFile__20ba6"}},61:function(e,t,n){e.exports={loginForm:"profileDataForm_loginForm__3tiaF",profileDataForm:"profileDataForm_profileDataForm__evRJp"}},62:function(e,t,n){e.exports={logout:"logout_logout__3_g-Z"}},76:function(e,t,n){e.exports={main:"dialogs_main__1fhtb",chats:"dialogs_chats__l1pWy"}},77:function(e,t,n){e.exports={likes:"post_likes__2V2RY",main:"post_main__3Si4N"}},78:function(e,t,n){e.exports={profileData:"profileData_profileData__-ZTgS",contact:"profileData_contact__22zJo",infoItem:"profileData_infoItem__h34qX"}},79:function(e,t,n){e.exports={itemList:"itemList_itemList__NoNK-",items:"itemList_items__oh8b0"}},80:function(e,t,n){e.exports={header:"header_header__2tX34",icon:"header_icon__1dBpx"}},81:function(e,t,n){e.exports={loginForm:"loginForm_loginForm__2uAyW"}},83:function(e,t,n){e.exports={chatMessages:"chatMessages_chatMessages__3xFVG",message:"chatMessages_message__2iuet"}},84:function(e,t,n){e.exports={main:"sendMessage_main__2aHTT",textarea:"sendMessage_textarea__rw41D"}}},[[267,1,2]]]);
//# sourceMappingURL=main.6cd9fff8.chunk.js.map